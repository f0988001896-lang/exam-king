<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é†«å¸«äºŒéšåœ‹è€ƒè§£é¡Œç‹</title>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: "Microsoft JhengHei", sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
}

h1 {
    text-align: center;
    color: white;
    font-size: 2.5em;
    margin: 20px 0;
}

.subtitle {
    text-align: center;
    color: white;
    font-size: 1.3em;
    margin: 10px 0;
}

.stats {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 15px;
    padding: 20px;
    margin: 20px 0;
    display: flex;
    justify-content: space-around;
    color: white;
    text-align: center;
}

.stat-num {
    display: block;
    font-size: 2em;
    font-weight: bold;
}

.grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.card {
    background: white;
    border-radius: 15px;
    padding: 25px;
    cursor: pointer;
    transition: transform 0.3s;
}

.card:hover {
    transform: translateY(-5px);
}

.card.unlocked {
    border: 2px solid #10b981;
}

.question-num {
    background: #667eea;
    color: white;
    padding: 8px 18px;
    border-radius: 25px;
    font-weight: bold;
    display: inline-block;
    margin-bottom: 15px;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 20px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 15px;
}

.btn-buy {
    background: #667eea;
    color: white;
}

.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: 1000;
}

.modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-content {
    background: white;
    border-radius: 20px;
    padding: 40px;
    max-width: 600px;
    width: 90%;
}

.modal-content h3 {
    margin-bottom: 20px;
}

.info-box {
    background: #f3f4f6;
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
}

.video-box {
    margin: 20px 0;
    background: black;
    border-radius: 10px;
}

.video-box iframe {
    width: 100%;
    height: 350px;
    border: none;
}

.full-width {
    width: 100%;
}
</style>
</head>
<body>

<div class="container">
    <h1>ğŸ¥ é†«å¸«äºŒéšåœ‹è€ƒè§£é¡Œç‹</h1>
    <div class="subtitle">114å¹´åº¦å…§ç§‘å°ˆå€ Â· æ¯é¡ŒNT$5</div>
    
    <div class="stats">
        <div><span class="stat-num" id="total-count">0</span>é¡Œç›®ç¸½æ•¸</div>
        <div><span class="stat-num" id="uploaded-count">0</span>å·²ä¸Šæ¶</div>
        <div><span class="stat-num" id="unlocked-count">0</span>å·²è§£é–</div>
    </div>
    
    <div class="grid" id="question-grid"></div>
</div>

<div class="modal" id="modal" tabindex="-1">
    <div class="modal-content" id="modal-content">
        <h3 id="modal-title"></h3>
        <div id="modal-body"></div>
    </div>
</div>

<script>
var questions = [
    {id: "114-1", title: "114å¹´å…§ç§‘ç¬¬1é¡Œ", video: "7v6fx1L2C24", price: 5},
    {id: "114-2", title: "114å¹´å…§ç§‘ç¬¬2é¡Œ", video: "", price: 5},
    {id: "114-3", title: "114å¹´å…§ç§‘ç¬¬3é¡Œ", video: "", price: 5},
    {id: "114-4", title: "114å¹´å…§ç§‘ç¬¬4é¡Œ", video: "", price: 5},
    {id: "114-5", title: "114å¹´å…§ç§‘ç¬¬5é¡Œ", video: "", price: 5},
    {id: "114-6", title: "114å¹´å…§ç§‘ç¬¬6é¡Œ", video: "", price: 5},
    {id: "114-7", title: "114å¹´å…§ç§‘ç¬¬7é¡Œ", video: "", price: 5},
    {id: "114-8", title: "114å¹´å…§ç§‘ç¬¬8é¡Œ", video: "", price: 5},
    {id: "114-9", title: "114å¹´å…§ç§‘ç¬¬9é¡Œ", video: "", price: 5},
    {id: "114-10", title: "114å¹´å…§ç§‘ç¬¬10é¡Œ", video: "", price: 5}
];

function getUnlocked() {
    var saved = localStorage.getItem('unlocked');
    if (saved) {
        try {
            return JSON.parse(saved);
        } catch (e) {
            return [];
        }
    }
    return [];
}

function saveUnlock(questionId) {
    var unlocked = getUnlocked();
    if (unlocked.indexOf(questionId) === -1) {
        unlocked.push(questionId);
        localStorage.setItem('unlocked', JSON.stringify(unlocked));
    }
}

function isUnlocked(questionId) {
    var unlocked = getUnlocked();
    return unlocked.indexOf(questionId) >= 0;
}

function showQuestions() {
    var grid = document.getElementById('question-grid');
    grid.innerHTML = '';
    
    var totalCountEl = document.getElementById('total-count');
    var uploadedCountEl = document.getElementById('uploaded-count');
    totalCountEl.textContent = questions.length;
    var uploadedCount = questions.filter(function(q){ return q.video && q.video.length > 0; }).length;
    uploadedCountEl.textContent = uploadedCount;

    for (var i = 0; i < questions.length; i++) {
        var q = questions[i];
        var unlocked = isUnlocked(q.id);
        var hasVideo = q.video && q.video.length > 0;
        
        var card = document.createElement('div');
        card.className = 'card';
        if (unlocked) {
            card.className = 'card unlocked';
        }
        
        var html = '<div class="question-num">' + q.id + '</div>';
        html += '<div>' + q.title + '</div>';
        
        if (!hasVideo) {
            html += '<div>ğŸ”œ æº–å‚™ä¸­</div>';
            // non-clickable
        } else if (unlocked) {
            html += '<button class="btn btn-buy">âœ… å·²è§£é–</button>';
            card.setAttribute('data-index', i);
            card.onclick = function() {
                var idx = this.getAttribute('data-index');
                showModal(questions[idx]);
            };
        } else {
            html += '<button class="btn btn-buy">NT$' + q.price + '</button>';
            card.setAttribute('data-index', i);
            card.onclick = function() {
                var idx = this.getAttribute('data-index');
                showModal(questions[idx]);
            };
        }
        
        card.innerHTML = html;
        grid.appendChild(card);
    }
    
    document.getElementById('unlocked-count').textContent = getUnlocked().length;
}

function showModal(question) {
    var modal = document.getElementById('modal');
    var title = document.getElementById('modal-title');
    var body = document.getElementById('modal-body');
    
    title.textContent = question.title;
    
    var unlocked = isUnlocked(question.id);
    
    if (unlocked) {
        body.innerHTML = '<div class="video-box"><iframe src="https://www.youtube.com/embed/' + encodeURIComponent(question.video) + '?rel=0" allowfullscreen></iframe></div>' +
                         '<button class="btn full-width" onclick="closeModal()">é—œé–‰</button>';
    } else {
        body.innerHTML = '<div class="info-box"><p><strong>é¡Œç›®:</strong> ' + question.title + '</p>' +
                         '<p><strong>åƒ¹æ ¼:</strong> NT$' + question.price + '</p>' +
                         '<p>ğŸ’° è§£é–å¾Œæ°¸ä¹…è§€çœ‹</p></div>' +
                         '<button class="btn btn-buy full-width" onclick="buyQuestion(\'' + question.id + '\')">ä»˜è²»è§£é– NT$' + question.price + '</button>';
    }
    
    // show modal and focus for accessibility (so Esc can work)
    modal.className = 'modal active';
    modal.focus();
}

// close modal
function closeModal() {
    document.getElementById('modal').className = 'modal';
}

// buy flow (test mode)
function buyQuestion(questionId) {
    if (confirm('æ¸¬è©¦æ¨¡å¼\nç¢ºå®šä»˜æ¬¾?')) {
        saveUnlock(questionId);
        alert('âœ… ä»˜æ¬¾æˆåŠŸ!');
        closeModal();
        showQuestions();
        // automatically open the modal for the newly unlocked question
        for (var i = 0; i < questions.length; i++) {
            if (questions[i].id === questionId) {
                showModal(questions[i]);
                break;
            }
        }
    }
}

// close modal on backdrop click
document.getElementById('modal').addEventListener('click', function(e){
    if (e.target.id === 'modal') {
        closeModal();
    }
});

// close modal on Esc
document.addEventListener('keydown', function(e){
    if (e.key === 'Escape') {
        closeModal();
    }
});

showQuestions();
</script>

</body>
</html>